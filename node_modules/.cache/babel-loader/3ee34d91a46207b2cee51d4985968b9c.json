{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hp\\\\Desktop\\\\React Authentication\\\\src\\\\components\\\\store\\\\auth-context.js\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useEffect } from \"react\";\nimport { useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet logoutTimer;\nconst AuthContext = /*#__PURE__*/React.createContext({\n  token: \"\",\n  isLoggedIn: false,\n  login: token => {},\n  logout: () => {}\n});\n\nconst calculateRemainingTime = expirationTime => {\n  const currentTime = new Date().getTime();\n  const adjustedTime = new Date(expirationTime).getTime();\n  const remainingDuration = adjustedTime - currentTime;\n  return remainingDuration;\n};\n\nconst retrieveStoredToken = () => {\n  const storedToken = localStorage.getItem('token');\n  const storedExpirationTime = localStorage.getItem('expirationTime');\n  const remainingTime = calculateRemainingTime(storedExpirationTime);\n\n  if (remainingTime <= 3600) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('expirationTime');\n    return null;\n  }\n\n  return {\n    token: storedToken,\n    duration: remainingTime\n  };\n}; //we will use this method in Index.js file\n\n\nexport const AuthContextProvider = props => {\n  _s();\n\n  const tokenData = retrieveStoredToken();\n  let initialState; //tokenData use to set \n\n  if (tokenData) {\n    initialState = tokenData.token;\n  }\n\n  const [token, setToken] = useState(initialState);\n  const userIsLoggedIn = !!token; //if the string will be empty it will be a false boolean if it has something inside the string it will show true;\n\n  const logoutHandler = useCallback(() => {\n    setToken(null);\n    localStorage.removeItem('token');\n    localStorage.removeItem('expirationTime');\n\n    if (logoutTimer) {\n      clearTimeout(logoutTimer);\n    }\n  }, []); //in this login handler  we have use setTimeout and some other expirations to set timeout\n\n  const loginHandler = (token, expirationTime) => {\n    setToken(token);\n    localStorage.setItem('token', token);\n    localStorage.setItem('expirationTime', expirationTime);\n    const remainingTime = calculateRemainingTime(expirationTime);\n    logoutTimer = setTimeout(logoutHandler, remainingTime);\n  };\n\n  useEffect(() => {\n    if (tokenData) {\n      console.log(tokenData.duration);\n      logoutTimer = setTimeout(logoutHandler, tokenData.duration);\n    }\n  }, [tokenData, logoutHandler]);\n  const contextValue = {\n    token: token,\n    isLoggedIn: userIsLoggedIn,\n    login: loginHandler,\n    logout: logoutHandler\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextValue,\n    children: [\" \", props.children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthContextProvider, \"d9lmJPmc+V2wcur5bZD97HOMLqw=\");\n\n_c = AuthContextProvider;\nexport default AuthContext; //we will import this in AuthForm \n\nvar _c;\n\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","logoutTimer","AuthContext","createContext","token","isLoggedIn","login","logout","calculateRemainingTime","expirationTime","currentTime","Date","getTime","adjustedTime","remainingDuration","retrieveStoredToken","storedToken","localStorage","getItem","storedExpirationTime","remainingTime","removeItem","duration","AuthContextProvider","props","tokenData","initialState","setToken","userIsLoggedIn","logoutHandler","clearTimeout","loginHandler","setItem","setTimeout","console","log","contextValue","children"],"sources":["C:/Users/hp/Desktop/React Authentication/src/components/store/auth-context.js"],"sourcesContent":["import React, { useCallback, useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nlet logoutTimer;\r\nconst AuthContext = React.createContext({\r\n  token: \"\",\r\n  isLoggedIn: false,\r\n  login: (token) => {},\r\n  logout: () => {},\r\n});\r\nconst calculateRemainingTime =(expirationTime)=>{\r\n  const currentTime = new Date().getTime();\r\n  const adjustedTime = new Date(expirationTime).getTime();\r\n  const remainingDuration =adjustedTime - currentTime;\r\n  return remainingDuration;\r\n}\r\nconst retrieveStoredToken =()=>{\r\n  const storedToken = localStorage.getItem('token');\r\n  const storedExpirationTime =localStorage.getItem('expirationTime');\r\n  const remainingTime = calculateRemainingTime(storedExpirationTime);\r\n  if(remainingTime<=3600){\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('expirationTime');\r\n    return null;\r\n  }\r\n  return{\r\n    token:storedToken,\r\n    duration:remainingTime\r\n  }\r\n}\r\n//we will use this method in Index.js file\r\nexport const AuthContextProvider = (props) => {\r\n  const tokenData=retrieveStoredToken();\r\n let initialState;\r\n //tokenData use to set \r\n  if(tokenData){\r\n    initialState = tokenData.token;\r\n  }\r\n  const [token, setToken] = useState(initialState);\r\n  const userIsLoggedIn = !!token; //if the string will be empty it will be a false boolean if it has something inside the string it will show true;\r\n \r\n  const logoutHandler = useCallback(() => {\r\n    setToken(null);\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('expirationTime')\r\n    if(logoutTimer){\r\n      clearTimeout(logoutTimer)\r\n    }\r\n\r\n  },[]);\r\n  //in this login handler  we have use setTimeout and some other expirations to set timeout\r\n   const loginHandler = (token,expirationTime) => {\r\n    setToken(token);\r\n    localStorage.setItem('token',token);\r\n    localStorage.setItem('expirationTime' ,expirationTime)\r\n    const remainingTime =calculateRemainingTime(expirationTime);\r\n    logoutTimer=setTimeout(logoutHandler,remainingTime)\r\n  };\r\n  useEffect(()=>{\r\n    if(tokenData){\r\n      console.log(tokenData.duration);\r\n      logoutTimer=setTimeout(logoutHandler,tokenData.duration) \r\n    }\r\n  },[tokenData,logoutHandler]);\r\n  const contextValue = {\r\n\r\n    token: token,\r\n    isLoggedIn: userIsLoggedIn,\r\n    login: loginHandler,\r\n    logout: logoutHandler,\r\n  };\r\n  return (\r\n    <AuthContext.Provider value={contextValue}>\r\n      {\" \"}\r\n      {props.children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\nexport default AuthContext;\r\n//we will import this in AuthForm \r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}